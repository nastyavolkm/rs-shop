<div class="good" *ngIf="good$ | async as good">
  <h2 class="good__heading">{{ good.name }}</h2>
  <ul class="good__rating-wrapper">
    <li *ngFor="let i of goodsService.getCountOfRating(good.rating)">
      <img src="../../../assets/rating.png" alt="rating" class="good__rating-star" />
    </li>
  </ul>
  <div class="good__card-wrapper">
    <div class="good__images-wrapper">
      <ul class="good__images-list">
        <li
          class="good__images-item"
          *ngFor="let image of good.imageUrls; let i = index; first as isFirst"
          (click)="onSelect(image, i)"
          [ngClass]="{ 'active-image': (!selectedImage && isFirst) || selectedImageIndex === i }"
        >
          <img src="{{ image }}" alt="{{ good.name }}" class="good__thumb" />
        </li>
      </ul>
    </div>
    <div class="good__image-wrapper">
      <img
        *ngIf="good.rating === 5"
        src="../../../assets/thumbup.png"
        alt="thumpup"
        class="good__thumbup"
      />
      <img
        *ngIf="selectedImage; else initialImage"
        src="{{ selectedImage }}"
        alt="{{ good.name }}"
        class="good__big-img"
      />
      <ng-template #initialImage>
        <img
          [src]="
            good.imageUrls.length > 0
              ? good.imageUrls[0]
              : '../../../../assets/default_preview.jpeg'
          "
          alt="{{ good.name }}"
          class="good__big-img"
        />
      </ng-template>
    </div>
    <div class="good__info">
      <h5 class="good__price">{{ good.price }}p.</h5>
      <div class="good__like-wrapper">
        <svg
          (click)="onLikeClick()"
          class="good__like"
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 20 20"
        >
          <path
            [ngStyle]="{
              fill: isGoodFavorite ? '#EC0A0A' : 'none'
            }"
            stroke="#EC0A0A"
            stroke-width="2"
            d="M10.003 17.414l.783-.691c4.865-4.317 6.388-5.849 7.44-7.759.522-.948.774-1.843.774-2.76 0-2.45-1.967-4.37-4.5-4.37-1.423 0-2.828.644-3.746 1.697L10 4.395l-.754-.864C8.328 2.478 6.923 1.833 5.5 1.833c-2.533 0-4.5 1.92-4.5 4.37 0 .922.255 1.82.781 2.774 1.054 1.907 2.588 3.447 7.433 7.737l.789.7z"
          />
        </svg>
        <span class="good__like-text">{{
          isGoodFavorite ? 'Удалить из избранного' : 'Добавить в избранное'
        }}</span>
      </div>
      <button
        class="good__btn-cart"
        *ngIf="!addedToCart"
        [disabled]="good.availableAmount === 0"
        (click)="$event.stopPropagation(); addedToCart = true"
      >
        <img src="../../../assets/cart.png" alt="cart" class="good__btn-cart-img" />
        В корзину
      </button>
      <button
        class="good__btn-cart inactive"
        *ngIf="addedToCart"
        (click)="router.navigate(['order'])"
      >
        <img src="../../../assets/cart.png" alt="cart" class="good__btn-cart-img" />
        В корзине
      </button>
    </div>
  </div>
  <div class="good__description">
    <div class="good__description-heading-wrapper">
      <p class="good__description-heading">Обзор</p>
      <div class="good__description-heading-neighbour"></div>
    </div>
    <span class="good__description-text">{{ good.description }}</span>
  </div>
</div>
